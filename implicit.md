–î–ª—è **–Ω–µ—è–≤–Ω–æ–π —Å—Ö–µ–º—ã (implicit method)** —Ä–µ—à–µ–Ω–∏—è —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç–∏:

$$
\frac{\partial U}{\partial t} = 4\frac{\partial^2 U}{\partial x^2} + \frac{\partial U}{\partial x} + f(x, t)
$$

–º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–¥–≤—É—Ö—Å–ª–æ–π–Ω—É—é —Å—Ö–µ–º—É —Å –ø–æ–ª–Ω–æ–π –Ω–µ—è–≤–Ω–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏**.

---

## üîß –ü–æ–¥—Ö–æ–¥

![img_2.png](img_2.png)

**–ù–µ—è–≤–Ω–∞—è —Å—Ö–µ–º–∞** —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—à–µ–Ω–∏—è –°–õ–ê–£ –Ω–∞ –∫–∞–∂–¥–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ:

$$
\frac{U_i^{n+1} - U_i^n}{\tau} = 4 \cdot \frac{U_{i+1}^{n+1} - 2U_i^{n+1} + U_{i-1}^{n+1}}{h^2}
+ \frac{U_{i+1}^{n+1} - U_{i-1}^{n+1}}{2h}
+ f(x_i, t_{n+1})
$$

–ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫:

$$
- A \cdot U_{i-1}^{n+1} + B \cdot U_i^{n+1} - C \cdot U_{i+1}^{n+1} = U_i^n + \tau \cdot f(x_i, t_{n+1})
$$

–≥–¥–µ:

* $A = \frac{4\tau}{h^2} + \frac{\tau}{2h}$
* $B = 1 + \frac{8\tau}{h^2}$
* $C = \frac{4\tau}{h^2} - \frac{\tau}{2h}$

---

## üßÆ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
import numpy as np

def solve_heat_equation_implicit(f_func, L=1.0, T=1.0, Nx=100, Nt=1000):
    h = L / Nx
    tau = T / Nt
    x = np.linspace(0, L, Nx + 1)
    t = np.linspace(0, T, Nt + 1)

    u = np.zeros((Nt + 1, Nx + 1))
    u[0, :] = (1.3 * x**2 + 1.2) * np.sin(np.pi * x)

    alpha = 4.0

    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã
    A = (alpha * tau / h**2) + (tau / (2*h))
    B = 1 + 2 * alpha * tau / h**2
    C = (alpha * tau / h**2) - (tau / (2*h))

    # –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ (—Ç—Ä–µ—Ö–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è)
    a = -A * np.ones(Nx - 1)
    b = B * np.ones(Nx - 0)
    c = -C * np.ones(Nx - 1)

    from scipy.linalg import solve_banded

    ab = np.zeros((3, Nx - 0))  # —Ç—Ä–µ—Ö–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥ –¥–ª—è solve_banded
    ab[0, 1:] = c  # –≤–µ—Ä—Ö–Ω—è—è –¥–∏–∞–≥–æ–Ω–∞–ª—å
    ab[1, :] = b   # –≥–ª–∞–≤–Ω–∞—è –¥–∏–∞–≥–æ–Ω–∞–ª—å
    ab[2, :-1] = a  # –Ω–∏–∂–Ω—è—è –¥–∏–∞–≥–æ–Ω–∞–ª—å

    for n in range(Nt):
        rhs = u[n, 1:Nx] + tau * np.array([f_func(xi, t[n+1]) for xi in x[1:Nx]])

        # –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (Neumann: –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è = 0 => "–∑–µ—Ä–∫–∞–ª—å–Ω–æ–µ" –∑–Ω–∞—á–µ–Ω–∏–µ)
        u[n+1, 0] = u[n+1, 1]
        u[n+1, Nx] = u[n+1, Nx - 1]

        # –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å —Å —É—á–µ—Ç–æ–º –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
        rhs[0] += A * u[n+1, 0]
        rhs[-1] += C * u[n+1, Nx]

        # –†–µ—à–∞–µ–º –°–õ–ê–£
        u[n+1, 1:Nx] = solve_banded((1, 1), ab, rhs)

    return x, t, u
```

---

### üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```python
f_zero = lambda x, t: 0.0
x, t, u = solve_heat_equation_implicit(f_zero, Nx=100, Nt=1000)
visualize_heat_equation(x, t, u)
```

---

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–µ—è–≤–Ω–æ–π —Å—Ö–µ–º—ã:

* **–ë–µ–∑—É—Å–ª–æ–≤–Ω–æ —É—Å—Ç–æ–π—á–∏–≤–∞** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —è–≤–Ω–æ–π —Å—Ö–µ–º–æ–π
* –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ —à–∞–≥–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –∑–∞–º–µ–Ω–∏—Ç—å `solve_banded` –Ω–∞ —Ä—É—á–Ω—ã–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≥–æ–Ω–∫–∏ (–º–µ—Ç–æ–¥ —Ç—Ä—ë—Ö–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã).
